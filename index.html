<!DOCTYPE html>
<html>
<head>
  <title>Welcome to Vue</title>
  <script src="https://unpkg.com/vue"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
  <div id="app">
    <div v-if="isFenwayGame(getGames())" class="redsox game-alert">
        <h1>Red Sox Home Game @ {{ fenwayGame.home_time }} {{ fenwayGame.ampm }}</h1>
    </div>
    <div v-if="!isFenwayGame(getGames())" class="game-alert nogame">
        <h1>No Red Sox Games Today</h1>
    </div>
  </div>

  <script>

    var app = new Vue({

      el: '#app',
      data: {
        greeting: 'Welcome to your Vue.js app!',
        docsURL: 'http://vuejs.org/guide/',
        discordURL: 'https://chat.vuejs.org',
        forumURL: 'http://forum.vuejs.org/',
        games: {},
        homeGames: {},
        fenwayGame: {},
      },
      methods: {
        getGames: function() {
          gameData = this
            .$data
            .games
            .data
            .data
            .games
            .game

          return gameData
        },
        humanizeURL: function (url) {
          return url
            .replace(/^https?:\/\//, '')
            .replace(/\/$/, '')
        },
        numGames: function() {
          let count = 0;
          for (game in this.getGames()) {
            count ++;
          }
          return count;
        },
        buildQuery: function (date) {
          let thisMonth = date.getMonth() + 100;
          thisMonth = thisMonth.toString().slice(-2);
          let queryString = "http://gd2.mlb.com/components/game/mlb/year_" + date.getFullYear() + "/month_" + thisMonth + "/day_" + (date.getDate() + 1) + '/miniscoreboard.json'
          return queryString;
        },
        isFenwayGame: function (games) {
          for (game in games) {
            if (games[game].home_team_city.indexOf("Boston") !== -1 ){
              this.fenwayGame = games[game];
              return true;
            }
          }
          return false;
        }
      },
      mounted () {
        axios
          .get(this.buildQuery(new Date()))
          .then(response => (this.games = response));
      }
    })

  </script>

  <style type="text/css">
  html{
    height: 100%;
  }
  body{
    padding: 0;
    margin: 0;
    height: 100%;
  }
  #app {
    display: flex;
    flex-flow: column nowrap;
    justify-content: stretch;
    align-items: stretch;
    padding: 0;
    height: 100%;
  }

  .game-alert {
    height: 100%;
    padding: 50px;
    text-align: center;
  }

  .game-alert h1 {
    text-align: center;
    font-size: 4rem;
    font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif
  }

  .nogame{
    background: lightgray;
    color: gray;
  }

  .redsox {
    background: red;
    color: white;
  }
  </style>
</body>
</html>
